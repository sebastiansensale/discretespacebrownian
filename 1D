This is the code in 1D
